@page "/autocomplete"

<style>
    .acWrapper {
        width: 500px;
        padding-bottom: 10px;
    }

        .acWrapper input {
            width: 100%;
        }

        .acWrapper ul {
            height: auto;
            margin: 0;
            padding: 0;
            border-width: 0;
            outline: 0;
            text-decoration: none;
            list-style: none;
        }

        .acWrapper li {
            padding: 2px 24px;
            min-height: 2em;
            line-height: 2em;
            white-space: normal;
        }

            .acWrapper li:hover {
                background-color: deepskyblue;
            }

    .acWrapper-List {
        border: solid black 2px;
    }
</style>

<h1>AutoComplete</h1>

<p> Try typing a European county</p>

<div class="acWrapper">
    <input type="text" placeholder=@Placeholder autocomplete="off" bind=@Value oninput=@OnInput />
    <div class="acWrapper-List" style="@(IsSuggestionsVisible ? "" : "display: none") ">
        <ul>
            @if (SuggestionListData.Length == 0)
            {
                <li>No Data Found!</li>
            }
            else
            {
                @foreach (var item in SuggestionListData)
                {
                    <li onclick=@(() => OnSuggestionSelect(@item))>@item</li>
                }
            }
        </ul>
    </div>
</div>

@functions {
    // TO DO
    /*
        DataSource IEnumerable
        OnTextChanged Action
        ThrottleLimit int
        MinLength int
        FilterType (Contains|StartwsWidth)
        DataFiledText
        Templates (Header, Footer, Item)
        MaxHeight

        Events (Select, Open, Close, DataBound, Filtering)

        ADVANCED AREAS
        Seperator
        Virtualization
        Grouping
    */


    string Placeholder = "Select a country...";
    string[] SuggestionListData;

    string[] TestData;

    string Value = "";
    bool IsSuggestionsVisible = false;

    protected override async Task OnInitAsync()
    {
        TestData = new string[] {
            "Albania",
            "Andorra",
            "Armenia",
            "Austria",
            "Azerbaijan",
            "Belarus",
            "Belgium",
            "Bosnia & Herzegovina",
            "Bulgaria",
            "Croatia",
            "Cyprus",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "Georgia",
            "Germany",
            "Greece",
            "Hungary",
            "Iceland",
            "Ireland",
            "Italy",
            "Kosovo",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Macedonia",
            "Malta",
            "Moldova",
            "Monaco",
            "Montenegro",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Romania",
            "Russia",
            "San Marino",
            "Serbia",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland",
            "Turkey",
            "Ukraine",
            "United Kingdom",
            "Vatican City"
      };

        SuggestionListData = TestData;
    }

    void OnInput(UIChangeEventArgs e)
    {
        string filterValue = e.Value.ToString().ToLower();
        IsSuggestionsVisible = filterValue != "";
        SuggestionListData = TestData.Where(x => x.ToLower().StartsWith(filterValue)).ToArray();
    }

    void OnSuggestionSelect(string item)
    {
        Value = item;
        IsSuggestionsVisible = false;
    }
}
